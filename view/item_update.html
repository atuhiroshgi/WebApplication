<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../common/css/normalize.css" rel="stylesheet" type="text/css">
    <link href="../common/css/main.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1>商品の更新</h1>
    <?php if(isset($arrErr) && count($arrErr) > 0){ ?>
        <div class="error">
            <?php foreach($arrErr as $err){ ?>
                <?= $err ?><br>
            <?php } ?>
        </div>
    <?php } ?>
    
    <form action="item_update.php" method="post">
        <table class="insertTbl">
            <tr>
                <th>商品名</th>
                <td>
                    <input type="text" name="item_name" value="<?= htmlspecialchars($sItemName) ?>" />
                    <?php if (isset($arrErr['item_name'])): ?>
                        <p class="error"><?= $arrErr['item_name'] ?></p>
                    <?php endif; ?>
                </td>
            </tr>
            <tr>
                <th>価格</th>
                <td>
                    <input type="text" name="item_price" value="<?= htmlspecialchars($nItemPrice) ?>" />
                    <?php if (isset($arrErr['item_price'])): ?>
                        <p class="error"><?= $arrErr['item_price'] ?></p>
                    <?php endif; ?>
                </td>
            </tr>
            <tr>
                <th>商品説明</th>
                <td>
                    <textarea name="item_text"><?= htmlspecialchars($sItemText) ?></textarea>
                </td>
            </tr>
            <tr>
                <th>カテゴリID</th>
                <td><input type="text" name="category_id" value="<?= htmlspecialchars($nCategoryId) ?>" /></td>
            </tr>
            <tr>
                <th>販売状態</th>
                <td>
                    <?php 
                    error_log("Form display - stop_flg value: " . $nStopFlg);
                    ?>
                    <select name="stop_flg">
                        <option value="0" <?php echo ($nStopFlg == 0) ? 'selected' : ''; ?>>販売中</option>
                        <option value="1" <?php echo ($nStopFlg == 1) ? 'selected' : ''; ?>>販売停止</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th>商品画像</th>
                <td><input type="text" name="item_image" value="<?= htmlspecialchars($sItemImage) ?>" /></td>
            </tr>
        </table>
        <div class="btnArea">
            <input type="hidden" name="item_id" value="<?php echo htmlspecialchars($item['item_id']); ?>">
            <input type="hidden" name="step" value="1" />
            <input type="submit" value="確認" />
        </div>
    </form>
    <div class="btnArea">
        <form action="index.php" method="post">
            <input type="submit" value="戻る" />
        </form>
    </div>
</body>
</html> 